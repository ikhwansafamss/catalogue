# Intro

This website contains a growing catalogue of Ikhwan al-Safa manuscripts.

The website is versioned: the index.html file in the root folder of the repository 
will redirect to the latest released version (releases are dated: vYYYY-MM-DD, e.g., v2024-05-30).

External users should only use the released version, which is citable and does not change.
The latest changes (since the latest release) are visible under https://ikhwansafamss.github.io/catalogue/work-in-progress.

This website is based on two data sources, both in Google drive: 
* a spreadsheet containing the main data in the table
* a word document containing more detailed descriptions of each manuscript

After Gowaart has updated one or both of these files, he can update the website in this way:
* go to the "Actions" tab in this repo
* click on "Update website" in the left-hand column
* click on the "Run workflow" dropdown on the right, and inside the dropdown on the "Run workflow" button.

This will download both the spreadsheet and the word document
into the `work-in-progress/data` folder
and rebuild the json file that is the data source for the details in the table.

(the website is also automatically updated whenever something in the repository was changed manually)

These changes will be visible only in the work-in-progress page
(https://ikhwansafamss.github.io/catalogue/work-in-progress). 

If Gowaart feels a new version is ready to release, he can do that 
by manually generating a new release version of the website: 
* go to the "Actions" tab in this repo
* click on "Manual release" in the left-hand column
* click on the "Run workflow" dropdown on the right, and inside the dropdown on the "Run workflow" button.

This will copy the work-in-progress folder and generate a new folder
named after today's date. Visitors of https://ikhwansafamss.github.io/catalogue 
will be automatically forwarded to this new release of the website.

# Setup

For this to work, you should:

1. enable GitHub Actions with the correct permissions:

* Under your repository name (IkhwanMss), click  Settings. If you cannot see the "Settings" tab, select the  dropdown menu, then click Settings.
* In the left sidebar, click  Actions, then click General.
* scroll down to "Workflow permissions", select "Read and write permissions" and press "save".

2. enable GitHub Pages:

* Under your repository name, click  Settings. If you cannot see the "Settings" tab, select the  dropdown menu, then click Settings.
* In the left sidebar, click  Pages
* Under "branch", choose "main", keep the default location as "root/"  and click "save"
The content of the root folder of your repo is now served under <your_github_name>.github.io/IkhwanMss
(and because we have put the index.html file in the root folder, that will be displayed by default when you go to that page)

# Folder structure

```
|- .github/
|     |- workflows/ : contains instructions for GitHub, used to update the website and create releases:
|           |- manual_release.yml: runs the `python/create_release` script
|           |                      when you click the workflow in the GitHub Actions tab
|           |- update_website.yml: script that runs on github server anytime something is changed to the repo;
|                                  it uses the scripts in the `python` folder to
|                                  download the spreadsheet (as .tsv) and Google Doc (as .docx)
|                                  and rebuild the description json file.
|- python/ : 
|    |- download_data.py: downloads the Google sheet (as .tsv) and Google Doc (as .docx)
|    |                    into the work-in-progress/data folder
|    |- parse_doc.py: parses the Google doc and converts it into a json file.
|    |- create_release.py: script that creates a new release version of the website
|    |                     (it copies the work-in-progress folder)
|- md/ : 
|    |- release-notes.md: a markdown file that lists the releases,
|    |                    and where you can take notes about what changed between releases.
|- templates/ : templates for the website's html files.
|- work-in-progress/ : contains all the data, images and scripts for the website
|    |- data/ : contains the data from which the website is built
|    |   |- msData.tsv: downloaded version of the spreadsheet
|    |   |- msDescriptions.docx: downloaded version of the google doc
|    |   |- msDescriptions.json: parsed version of the docx file (generated by `python/parse_doc.py`)
|    |- css/ : contains the css files that define the styling of the website
|    |- js/ : contains the javascript files that make the website interactive
|    |- img/ : contains all images needed for the website
|    |- index.html: main web page
|- vYYYY-MM-DD/ : release folder containing all the data, images and scripts 
|                 for a frozen version of the website
|- index.html: reroutes the visitor to the latest release
|- requirements.txt: a list of all Python libraries used by the Python scripts
|- README.md: this documentation file
```

TO DO: 
* user customization: let user decide which columns are shown in the table? (https://datatables.net/examples/api/show_hide.html)
* separate landing page?
* add a "how to cite this website?" section?

